!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n=document.getElementById("tetris"),o=n.getContext("2d"),r=document.getElementById("left"),i=document.getElementById("rotate"),c=document.getElementById("right"),l=document.getElementById("slam");function u(e,t){const[n,o]=[t.matrix,t.position];for(let t=0;t<n.length;t++)for(let r=0;r<n[t].length;r++)if(0!==n[t][r]&&0!==(e[t+o.y]&&e[t+o.y][r+o.x]))return!0;return!1}o.scale(20,20);const f=[null,"red","yellow","green","blue","orange","pink","purple"];function s(e,t){e.forEach((e,n)=>{e.forEach((e,r)=>{0!==e&&(o.fillStyle=f[e],o.fillRect(r+t.x,n+t.y,1,1))})})}function a(){S.position.y++,u(b,S)&&(S.position.y--,function(e,t){t.matrix.forEach((n,o)=>{n.forEach((n,r)=>{0!==n&&(e[o+t.position.y][r+t.position.x]=n)})})}(b,S),y(),function(){let e=1;e:for(let t=b.length-1;t>0;t--){for(let e=0;e<b[t].length;e++)if(0===b[t][e])continue e;const n=b.splice(t,1)[0].fill(0);b.unshift(n),t++,S.score+=10*e,S.score+=S.bricks,S.bricks=1,e*=2,S.score>S.highScore&&(S.highScore=S.score)}}(),d(),S.slam=!1),g=0}function d(){document.getElementById("score").innerText="Score: "+S.score,document.getElementById("highScore").innerText="High Score: "+S.highScore}function m(e){S.position.x+=e,u(b,S)&&(S.position.x-=e)}function y(){var e;S.matrix=(e="ILJOTSZ"["ILJOTSZ".length*Math.random()|0],S.bricks+=1,"T"===e?[[0,1,0],[1,1,1],[0,0,0]]:"O"===e?[[2,2],[2,2]]:"S"===e?[[0,3,3],[3,3,0],[0,0,0]]:"Z"===e?[[4,4,0],[0,4,4],[0,0,0]]:"L"===e?[[0,5,0],[0,5,0],[0,5,5]]:"J"===e?[[0,6,0],[0,6,0],[6,6,0]]:"I"===e?[[0,7,0,0],[0,7,0,0],[0,7,0,0],[0,7,0,0]]:void 0),S.position.y=0,S.position.x=(b[0].length/2|0)-(S.matrix[0].length/2|0),u(b,S)&&(b.forEach(e=>e.fill(0)),S.bricks=1,S.score=0,d())}function p(e){const t=S.position.x;h(S.matrix,e);let n=1;for(;u(b,S);)S.position.x+=n,n=-(n+(n>0?1:-1)),n>S.matrix[0].length&&(h(S.matrix,-e),S.position.x=t)}function h(e,t){for(let t=0;t<e.length;t++)for(let n=0;n<t;n++)[e[n][t],e[t][n]]=[e[t][n],e[n][t]];t>0?e.forEach(e=>e.reverse()):e.reverse()}let g=0,x=0;const b=function(e,t){const n=[];for(;t--;)n.push(new Array(e).fill(0));return n}(12,20);console.table(b);const S={position:{x:0,y:0},matrix:null,bricks:0,score:0,highScore:0,slam:!1};r.onclick=function(){m(-1)},c.onclick=function(){m(1)},i.onclick=function(){p(-1)},l.onclick=function(){S.slam=!0,a()},document.addEventListener("keydown",e=>{37===e.keyCode?m(-1):39===e.keyCode?m(1):40===e.keyCode?(S.slam=!0,a()):81===e.keyCode?p(-1):87===e.keyCode&&p(1)}),y(),d(),function e(t=0){const r=t-x;x=t,g+=r,S.slam&&a(),g>1e3&&a(),o.fillStyle="#000",o.fillRect(0,0,n.width,n.height),s(b,{x:0,y:0}),s(S.matrix,S.position),requestAnimationFrame(e)}()}]);